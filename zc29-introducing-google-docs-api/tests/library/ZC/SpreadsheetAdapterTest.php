<?php
/**
 * Test class for ZC_SpreadsheetAdapter.
 * Generated by PHPUnit on 2009-07-31 at 12:23:47.
 */

class ZC_SpreadsheetAdapterTest
    extends ControllerTestCase
{
    /**
     * @var    ZC_SpreadsheetAdapter
     * @access protected
     */
    protected $adapter;

    protected $testUser		= "zendcasts@gmail.com";
    protected $testPass		= "p@ssword";
    protected $testSpreadSheet	= "tvLp5unOsWD5zx-97tAxopw";

    public function setUp()
    {
	parent::setUp();

        $this->adapter = new ZC_SpreadsheetAdapter($this->testUser,$this->testPass,
						    $this->testSpreadSheet);
    }

    public function testCanGetColumns()
    {
	$columns = $this->adapter->getColumns();
	$this->assertTrue(is_array($columns));
    }
    public function testCanInsertRow()
    {
	$testPayload = array();
	foreach($this->adapter->getColumns() as $k)
	    $testPayload[strtolower($k)] = $k . substr(time(),6);

	$entries = $this->adapter->insertRow($testPayload);

	foreach($entries as $entry)
	{
	    $this->assertTrue($entry instanceof Zend_Gdata_App_Entry);
	}
    }
    public function testGetRows()
    {
	$this->assertTrue(is_array($this->adapter->getRows()));
    }
}
?>
